{"remainingRequest":"/Users/macbookpro/Documents/hr-manage/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/macbookpro/Documents/hr-manage/src/components/CommonTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/macbookpro/Documents/hr-manage/src/components/CommonTable.vue","mtime":1649684344230},{"path":"/Users/macbookpro/Documents/hr-manage/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macbookpro/Documents/hr-manage/node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macbookpro/Documents/hr-manage/node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/macbookpro/Documents/hr-manage/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/macbookpro/Documents/hr-manage/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IGRhdGEgPSBbXTsKZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgewogIGRhdGEucHVzaCh7CiAgICBrZXk6IGksCiAgICBuYW1lOiBgRWRyd2FyZCAke2l9YCwKICAgIGFnZTogMzIsCiAgICBhZGRyZXNzOiBgTG9uZG9uIFBhcmsgbm8uICR7aX1gLAogIH0pOwp9CmltcG9ydCAqIGFzIHJlcXVlc3QgZnJvbSAiQC9uZXR3b3JrL3JlcXVlc3QiCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgdGFibGVUeXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZwogICAgfSwKICAgIG5ld1N3aXRjaDogewogICAgICB0eXBlOiBOdW1iZXIKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgdGhpcy5jYWNoZURhdGEgPSBkYXRhLm1hcChpdGVtID0+ICh7IC4uLml0ZW0gfSkpOwogICAgcmV0dXJuIHsKICAgICAgZGF0YSwKICAgICAgY29sdW1uczogdW5kZWZpbmVkLAogICAgICBlZGl0aW5nS2V5OiAnJywKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDaGFuZ2UodmFsdWUsIGtleSwgY29sdW1uKSB7CiAgICAgIGNvbnN0IG5ld0RhdGEgPSBbLi4udGhpcy5kYXRhXTsKICAgICAgY29uc3QgdGFyZ2V0ID0gbmV3RGF0YS5maW5kKGl0ZW0gPT4ga2V5ID09PSBpdGVtLmtleSk7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXRbY29sdW1uXSA9IHZhbHVlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0KGtleSkgewogICAgICBjb25zdCBuZXdEYXRhID0gWy4uLnRoaXMuZGF0YV07CiAgICAgIGNvbnN0IHRhcmdldCA9IG5ld0RhdGEuZmluZChpdGVtID0+IGtleSA9PT0gaXRlbS5rZXkpOwogICAgICB0aGlzLmVkaXRpbmdLZXkgPSBrZXk7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICB0YXJnZXQuZWRpdGFibGUgPSB0cnVlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgIH0KICAgIH0sCiAgICBzYXZlKGtleSkgewogICAgICBjb25zdCBuZXdEYXRhID0gWy4uLnRoaXMuZGF0YV07CiAgICAgIGNvbnN0IG5ld0NhY2hlRGF0YSA9IFsuLi50aGlzLmNhY2hlRGF0YV07CiAgICAgIGNvbnN0IHRhcmdldCA9IG5ld0RhdGEuZmluZChpdGVtID0+IGtleSA9PT0gaXRlbS5rZXkpOwogICAgICBjb25zdCB0YXJnZXRDYWNoZSA9IG5ld0NhY2hlRGF0YS5maW5kKGl0ZW0gPT4ga2V5ID09PSBpdGVtLmtleSk7CiAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Q2FjaGUpIHsKICAgICAgICBkZWxldGUgdGFyZ2V0LmVkaXRhYmxlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXRDYWNoZSwgdGFyZ2V0KTsKICAgICAgICB0aGlzLmNhY2hlRGF0YSA9IG5ld0NhY2hlRGF0YTsKICAgICAgfQogICAgICB0aGlzLmVkaXRpbmdLZXkgPSAnJzsKICAgICAgdGhpcy5jYWNoZURhdGEgPSB0aGlzLmRhdGEubWFwKGl0ZW0gPT4gKHsgLi4uaXRlbSB9KSk7CiAgICAgIHRoaXMuJGVtaXQoJ3NhdmUnLCBuZXdEYXRhKQogICAgfSwKICAgIGNhbmNlbChrZXkpIHsKICAgICAgY29uc3QgbmV3RGF0YSA9IFsuLi50aGlzLmRhdGFdOwogICAgICBjb25zdCB0YXJnZXQgPSBuZXdEYXRhLmZpbmQoaXRlbSA9PiBrZXkgPT09IGl0ZW0ua2V5KTsKICAgICAgdGhpcy5lZGl0aW5nS2V5ID0gJyc7CiAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldCwgdGhpcy5jYWNoZURhdGEuZmluZChpdGVtID0+IGtleSA9PT0gaXRlbS5rZXkpKTsKICAgICAgICBkZWxldGUgdGFyZ2V0LmVkaXRhYmxlOwogICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgIH0KICAgIH0sCiAgICBnZXRDb2x1bW5zICgpIHsKICAgICAgcmVxdWVzdC5yZXF1ZXN0KHsKICAgICAgdXJsOiB0aGlzLmdldEJhc2VVcmwoKSArICdnZXRfY29sdW1ucy8nLAogICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgZGF0YToge3RhYmxlVHlwZTogdGhpcy50YWJsZVR5cGV9CiAgICAgIH0pLnRoZW4ocmVzID0+ewogICAgICAgIHRoaXMuY29sdW1ucyA9IHJlcy5kYXRhLmNvbHVtbnM7CiAgICAgIH0pLmNhdGNoKGVyciA9PnsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9KQogICAgfSwKICAgIGdldERhdGEgKCkgewogICAgICByZXF1ZXN0LnJlcXVlc3QoewogICAgICB1cmw6IHRoaXMuZ2V0QmFzZVVybCgpICsgJ2dldF90YWJsZVR5cGVfZGF0YS8nLAogICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgZGF0YToge3RhYmxlVHlwZTogdGhpcy50YWJsZVR5cGV9CiAgICAgIH0pLnRoZW4ocmVzID0+ewogICAgICAgIHRoaXMuY29sdW1ucyA9IHJlcy5kYXRhLmNvbHVtbnM7CiAgICAgIH0pLmNhdGNoKGVyciA9PnsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9KQogICAgfQogIH0sCiAgY3JlYXRlZCAoKSB7CiAgICB0aGlzLmdldENvbHVtbnMoKQogIH0sCiAgd2F0Y2g6IHsKICAgIG5ld1N3aXRjaDp7CiAgICAgIGhhbmRsZXIgKCkgewogICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLmRhdGEubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgICAgICB0aGlzLmRhdGFbaW5kZXhdLmtleSArPSAxOwogICAgICAgIH0KICAgICAgICB0aGlzLmRhdGEudW5zaGlmdCh7CiAgICAgICAgICBrZXk6IDAsCiAgICAgICAgICBuYW1lOiB1bmRlZmluZWQsCiAgICAgICAgICBhZ2U6IHVuZGVmaW5lZCwKICAgICAgICAgIGFkZHJlc3M6IHVuZGVmaW5lZCwKICAgICAgICB9KTsKICAgICAgICB0aGlzLmNhY2hlRGF0YSA9IHRoaXMuZGF0YS5tYXAoaXRlbSA9PiAoeyAuLi5pdGVtIH0pKTsKICAgICAgICBjb25zdCBuZXdEYXRhID0gWy4uLnRoaXMuZGF0YV07CiAgICAgICAgY29uc3QgdGFyZ2V0ID0gbmV3RGF0YS5maW5kKGl0ZW0gPT4gMCA9PT0gaXRlbS5rZXkpOwogICAgICAgIHRoaXMuZWRpdGluZ0tleSA9IDA7CiAgICAgICAgaWYgKHRhcmdldCkgewogICAgICAgICAgdGFyZ2V0LmVkaXRhYmxlID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZGF0YSA9IG5ld0RhdGE7CiAgICAgICAgfQogICAgICAgIAogICAgICB9CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["CommonTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"CommonTable.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <a-table v-if=\"columns\" :columns=\"columns\" :data-source=\"data\" bordered :pagination=\"{ pageSize: 15 }\"  :scroll=\"{ x: 1500, y: 400 }\">\n    <template\n      v-for=\"col in ['name', 'age', 'address']\"\n      :slot=\"col\"\n      slot-scope=\"text, record\"\n    >\n      <div :key=\"col\">\n        <a-input\n          v-if=\"record.editable\"\n          style=\"margin: -5px 0\"\n          :value=\"text\"\n          @change=\"e => handleChange(e.target.value, record.key, col)\"\n        />\n        <template v-else>\n          {{ text }}\n        </template>\n      </div>\n    </template>\n    <template slot=\"operation\" slot-scope=\"text, record\">\n      <div class=\"editable-row-operations\">\n        <span v-if=\"record.editable\">\n          <a @click=\"() => save(record.key)\">Save</a>\n          <a-popconfirm title=\"Sure to cancel?\" @confirm=\"() => cancel(record.key)\">\n            <a>Cancel</a>\n          </a-popconfirm>\n        </span>\n        <span v-else>\n          <a :disabled=\"editingKey !== ''\" @click=\"() => edit(record.key)\">Edit</a>\n        </span>\n      </div>\n    </template>\n  </a-table>\n</template>\n<script>\nconst data = [];\nfor (let i = 0; i < 100; i++) {\n  data.push({\n    key: i,\n    name: `Edrward ${i}`,\n    age: 32,\n    address: `London Park no. ${i}`,\n  });\n}\nimport * as request from \"@/network/request\"\nexport default {\n  props: {\n    tableType: {\n      type: String\n    },\n    newSwitch: {\n      type: Number\n    },\n  },\n  data() {\n    this.cacheData = data.map(item => ({ ...item }));\n    return {\n      data,\n      columns: undefined,\n      editingKey: '',\n    };\n  },\n  methods: {\n    handleChange(value, key, column) {\n      const newData = [...this.data];\n      const target = newData.find(item => key === item.key);\n      if (target) {\n        target[column] = value;\n        this.data = newData;\n      }\n    },\n    edit(key) {\n      const newData = [...this.data];\n      const target = newData.find(item => key === item.key);\n      this.editingKey = key;\n      if (target) {\n        target.editable = true;\n        this.data = newData;\n      }\n    },\n    save(key) {\n      const newData = [...this.data];\n      const newCacheData = [...this.cacheData];\n      const target = newData.find(item => key === item.key);\n      const targetCache = newCacheData.find(item => key === item.key);\n      if (target && targetCache) {\n        delete target.editable;\n        this.data = newData;\n        Object.assign(targetCache, target);\n        this.cacheData = newCacheData;\n      }\n      this.editingKey = '';\n      this.cacheData = this.data.map(item => ({ ...item }));\n      this.$emit('save', newData)\n    },\n    cancel(key) {\n      const newData = [...this.data];\n      const target = newData.find(item => key === item.key);\n      this.editingKey = '';\n      if (target) {\n        Object.assign(target, this.cacheData.find(item => key === item.key));\n        delete target.editable;\n        this.data = newData;\n      }\n    },\n    getColumns () {\n      request.request({\n      url: this.getBaseUrl() + 'get_columns/',\n      method: 'post',\n      data: {tableType: this.tableType}\n      }).then(res =>{\n        this.columns = res.data.columns;\n      }).catch(err =>{\n        console.log(err);\n      })\n    },\n    getData () {\n      request.request({\n      url: this.getBaseUrl() + 'get_tableType_data/',\n      method: 'post',\n      data: {tableType: this.tableType}\n      }).then(res =>{\n        this.columns = res.data.columns;\n      }).catch(err =>{\n        console.log(err);\n      })\n    }\n  },\n  created () {\n    this.getColumns()\n  },\n  watch: {\n    newSwitch:{\n      handler () {\n        for (let index = 0; index < this.data.length; index++) {\n          this.data[index].key += 1;\n        }\n        this.data.unshift({\n          key: 0,\n          name: undefined,\n          age: undefined,\n          address: undefined,\n        });\n        this.cacheData = this.data.map(item => ({ ...item }));\n        const newData = [...this.data];\n        const target = newData.find(item => 0 === item.key);\n        this.editingKey = 0;\n        if (target) {\n          target.editable = true;\n          this.data = newData;\n        }\n        \n      }\n    },\n  }\n};\n</script>\n<style scoped>\n.editable-row-operations a {\n  margin-right: 8px;\n}\n</style>\n"]}]}